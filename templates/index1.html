<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PotholeDetector - Real-time Road Damage Detection</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    />
    <style>
      #map {
        height: 500px;
      }
      .severity-high {
        border-left: 5px solid #dc3545;
      }
      .severity-medium {
        border-left: 5px solid #ffc107;
      }
      .severity-low {
        border-left: 5px solid #28a745;
      }
      #video,
      #canvas {
        max-width: 100%;
        height: auto;
      }
      .camera-container {
        position: relative;
      }
      .detection-overlay {
        position: absolute;
        top: 0;
        left: 0;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand" href="#">üï≥Ô∏è PotholeDetector</a>
      </div>
    </nav>

    <div class="container mt-4">
      <div class="row">
        <!-- Left Column -->
        <div class="col-md-6">
          <!-- Camera & Detection -->
          <div class="card">
            <div class="card-header">
              <h5>Real-time Pothole Detection</h5>
            </div>
            <div class="card-body">
              <div
                id="statusAlert"
                class="alert alert-info py-2"
                style="display: none"
              ></div>
              <div class="camera-container mb-3">
                <video id="video" autoplay playsinline></video>
                <canvas id="canvas" class="detection-overlay"></canvas>
              </div>
              <div class="d-grid gap-2 mb-2">
                <button id="captureBtn" class="btn btn-primary">
                  Capture & Detect
                </button>
                <button id="uploadBtn" class="btn btn-secondary">
                  Upload Image
                </button>
                <input type="file" id="fileInput" accept="image/*" hidden />
              </div>
              <div id="detectionResult" class="mt-3"></div>
              <div id="pdfExportContainer" class="mt-2" style="display: none">
                <a id="downloadPdfBtn" class="btn btn-success" target="_blank"
                  >Download PDF Report</a
                >
              </div>
            </div>
          </div>

          <!-- Location Info -->
          <div class="card mt-4">
            <div class="card-header">
              <h5>Location Information</h5>
            </div>
            <div class="card-body">
              <div id="locationInfo">
                <p>Latitude: <span id="latitude">-</span></p>
                <p>Longitude: <span id="longitude">-</span></p>
                <button id="getLocation" class="btn btn-outline-primary btn-sm">
                  Get Current Location
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column -->
        <div class="col-md-6">
          <!-- Recent Detections -->
          <div class="card">
            <div
              class="card-header d-flex justify-content-between align-items-center"
            >
              <h5>Recent Detections</h5>
              <a
                href="/map"
                class="btn btn-sm btn-outline-primary"
                target="_blank"
                >View Map</a
              >
            </div>
            <div class="card-body">
              <div
                id="potholesList"
                style="max-height: 400px; overflow-y: auto"
              ></div>
            </div>
          </div>

          <!-- Live Map -->
          <div class="card mt-4">
            <div class="card-header">
              <h5>Live Map</h5>
            </div>
            <div class="card-body">
              <div id="map"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
  </body>
</html>
